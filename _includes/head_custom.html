<link rel="stylesheet" href="{{ '/assets/css/custom.css' | relative_url }}">

<script>
    document.addEventListener("DOMContentLoaded", function () {
        // 1. Determine Current Language
        const path = window.location.pathname;
        const isPt = path.includes("/pt/") || path.endsWith("/pt");
        const currentLang = isPt ? "pt" : "en";

        // Get baseurl from current path
        const pathParts = path.split('/');
        const baseurl = '/' + pathParts[1]; // e.g., /agentic-dev-guide

        // 2. Filter Sidebar Items
        const navItems = document.querySelectorAll('.nav-list-item');
        navItems.forEach(item => {
            const link = item.querySelector('.nav-list-link');
            if (!link) return;
            const href = link.getAttribute('href') || '';

            let itemLang = "common";
            if (href.includes("/pt/") || href.endsWith("/pt")) itemLang = "pt";
            else if (href.includes("/en/") || href.endsWith("/en")) itemLang = "en";

            if (currentLang === "pt" && itemLang === "en") {
                item.classList.add('lang-hidden');
            } else if (currentLang === "en" && itemLang === "pt") {
                item.classList.add('lang-hidden');
            }
        });

        // 3. Create Language Toggle in Header
        const auxNav = document.querySelector('.aux-nav-list');
        if (auxNav) {
            // Create new toggle as first item
            const toggle = document.createElement('li');
            toggle.className = 'aux-nav-list-item lang-toggle-wrapper';
            toggle.innerHTML = `
            <div class="lang-toggle">
                <a href="${baseurl}/en/" class="${currentLang === 'en' ? 'active' : ''}">EN</a>
                <a href="${baseurl}/pt/" class="${currentLang === 'pt' ? 'active' : ''}">PT</a>
            </div>
        `;
            auxNav.insertBefore(toggle, auxNav.firstChild);
        }
    });
</script>